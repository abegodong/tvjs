(function(f){var e,a,d={tv:function(){var b={33:"1",64:"2",35:"3",36:"4",37:"5",94:"6",38:"7",42:"8",40:"9",41:"0"};a.root.data("channel","");a.root.data("switchTo","");a.root.data("pipChannel","");a.root.data("pipSwitchTo","");a.root.data("pipLocation",0);e.channels=[{}].concat(e.channels);a=f.extend({content:f("<div />").attr("id","tv_content").css({width:"100%",height:"100%"}).appendTo(a.root),help:f("<div />").attr("id","tv_help").addClass("tv_help tv_wrap").appendTo(a.root),guide:f("<div />").attr("id",
    "tv_guide").addClass("tv_wrap").appendTo(a.root),pip:f("<div />").attr("id","tv_pip").addClass("tv_wrap").appendTo(a.root)},a);a.help.html(d.loadHelp());f(window).on("hashchange",function(){d.handleHashChange()});d.retrieveChannel();f(document).keypress(function(c){c=c.charCode;if(void 0!==c&&47<c&&58>c){clearTimeout(f.data(this,"timer"));var g=a.root.data("switchTo");if(48<c||""!==a.root.data("switchTo"))g=g.concat(c-48),a.root.data("switchTo",g);f(this).data("timer",setTimeout(function(){a.root.data("switchTo",
    a.root.data("switchTo")>>>0);window.location.hash=a.root.data("switchTo")},600))}else if(void 0!==c&&void 0!==b[c]&&!0===e.allowPiP){clearTimeout(f.data(this,"pipTimer"));g=a.root.data("pipSwitchTo");if(0<b[c]||""!==g)g=g.toString().concat(b[c]),a.root.data("pipSwitchTo",g);f(this).data("pipTimer",setTimeout(function(){a.root.data("pipSwitchTo",a.root.data("pipSwitchTo")>>>0);d.loadPiP()},600))}else!0!==e.allowPiP||80!==c&&112!==c?72===c||104===c?a.help.toggle():82===c||114===c?(a.root.data("switchTo",
    a.root.data("channel")),d.loadChannel(!0)):67===c||99===c?d.loadGuide(a.root.data("channel")):!0!==e.allowPiP||83!==c&&115!==c||(a.root.data("switchTo",a.root.data("pipChannel")),a.root.data("pipSwitchTo",a.root.data("channel")),window.location.hash=a.root.data("switchTo"),d.loadPiP()):d.movePiP()});f(document).keyup(function(b){var f=a.root.data("channel")>>>0;27===b.keyCode||81===b.keyCode?a.help.is(":visible")?a.help.toggle():a.pip.is(":visible")?(a.pip.toggle(),a.root.data("pipSwitchTo",a.root.data("pipChannel")),
    a.root.data("pipLocation",(a.root.data("pipLocation")-1)%5)):window.location.hash="":(37===b.keyCode||40===b.keyCode)&&1<=f-1?d.channelDown():(39===b.keyCode||38===b.keyCode)&&e.channels.length>f+1&&d.channelUp()});f(window).resize(function(){a.root.data("switchTo",a.root.data("channel"));d.loadChannel(!1)})},loadIntro:function(){/webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)?a.content.html('<div class="tv_message">Change URL Hash to Channel Number to start streaming</div>'):a.content.html('<div class="tv_message">Press "H" for help and see channels listing or press a number key to start streaming</div>');
    document.title=e.name;d.storeChannel("");a.root.data("switchTo","")},loadError:function(b){a.content.html('<div class="tv_message tv_error">'+{1:'Invalid Channel! Please enter valid channel number<br />or press "H" for help and see channels listing.',2:"Sorry this channel is not currently available for mobile device!",3:"General Error! Please try reloading site."}[b]+"</div>");d.loadTitle("Error! Error code: "+b);a.root.data("switchTo","")},loadTitle:function(a){!0===e.useTitle&&(document.title=a)},
    loadHelp:function(){var a="<p>To start streaming: press your number key corresponding to the channel number below.</p>",a=a+"<DL>";f.each(e.channels,function(c,d){a+="<DT>"+c+"</DT>";a+="<DD>"+d.name+"</DD>"});a+="</DL>";return a+='<p>Press "H" or "ESC" to close this help menu.<br />Press "R" to reload channel</p>'},loadGuide:function(b,c){if(""!==b){if(!1===("undefined"!==typeof c?c:!1))a.guide.css({top:"0",left:"0"});else{var d=a.pip.position();a.guide.css({top:d.top,left:d.left})}a.guide.html(e.channels[b].name).fadeIn(2E3).fadeOut(4E3)}},
    loadChannel:function(b){var c=a.root.data("switchTo");/webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)?!0===e.mobileSupport&&""!==e.channels[c].mobile?(!0===b&&d.loadGuide(c),a.content.html('<video width="100%" height="100%" src="'+e.channels[c].mobile+'" />'),d.loadTitle(e.channels[c].name)):(d.loadError(2),c=""):(!0===b&&d.loadGuide(c),a.content.html('<embed wmode="transparent" width="100%" height="100%" allowfullscreen="true" allowscriptaccess="always" bgcolor="#000000" flashvars="src='+
        e.channels[c].url+'&amp;autoHideControlBar=true&amp;streamType=live&amp;autoPlay=true&amp;scaleMode=stretch" pluginspage="http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash" quality="medium" src="http://fpdownload.adobe.com/strobe/FlashMediaPlayback_101.swf?rnd=4/[[DYNAMIC]]/1" type="application/x-shockwave-flash">'),d.loadTitle(e.channels[c].name));a.root.data("channel",c);d.storeChannel(c);a.root.data("switchTo","")},loadPiP:function(){var b=a.root.data("pipSwitchTo");
        /webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)?a.pip.html('<div class="tv_error">Feature not available in mobile devices.</div>'):a.pip.is(":visible")&&""!==b?void 0===e.channels[b]?(a.pip.html("Invalid Channel! Please enter valid channel number."),a.root.data("pipChannel",""),a.root.data("pipSwitchTo","")):(a.pip.html('<embed wmode="transparent" width="300" height="225" allowfullscreen="false" allowscriptaccess="always" bgcolor="#000000" flashvars="src='+e.channels[b].url+'&amp;autoHideControlBar=true&amp;streamType=live&amp;autoPlay=true&amp;scaleMode=stretch&amp;muted=true" pluginspage="http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash" quality="medium" src="http://fpdownload.adobe.com/strobe/FlashMediaPlayback_101.swf?rnd=4/[[DYNAMIC]]/1" type="application/x-shockwave-flash">'),
            a.root.data("pipChannel",b),a.root.data("pipSwitchTo",""),d.loadGuide(b,!0)):""===a.root.data("pipChannel")&&a.pip.html("Please select a PiP Channel.")},movePiP:function(){var b=(a.root.data("pipLocation")+1)%5;0===b&&a.pip.is(":visible")&&(a.root.data("pipSwitchTo",a.root.data("pipChannel")),a.pip.hide());1===b?(a.pip.css({top:"0",left:"0",right:"auto",bottom:"auto",display:"block"}),d.loadPiP()):2===b?(a.pip.css({top:"0",left:"auto",right:"0",bottom:"auto",display:"block"}),d.loadPiP()):3===b?(a.pip.css({top:"auto",
        left:"auto",right:"0",bottom:"0",display:"block"}),d.loadPiP()):4===b&&(a.pip.css({top:"auto",left:"0",right:"auto",bottom:"0",display:"block"}),d.loadPiP());a.root.data("pipLocation",b)},handleHashChange:function(){var b=window.location.hash.substring(1);"null"===b&&(b=window.location.hash="");""===b?d.loadIntro():void 0===e.channels[b]?(a.root.data("channel",""),a.root.data("switchTo",""),d.loadError(1)):(a.root.data("channel",b),a.root.data("switchTo",b),d.loadChannel(!0))},channelUp:function(){var b=
        a.root.data("channel")>>>0;a.root.data("switchTo",b+1);window.location.hash=a.root.data("switchTo")},channelDown:function(){var b=a.root.data("channel")>>>0;a.root.data("switchTo",b-1);window.location.hash=a.root.data("switchTo")},storeChannel:function(a){!0===e.useLocalStorage&&"undefined"!==typeof Storage&&localStorage.setItem("tvChannel",a)},removeChannel:function(){!0===e.useLocalStorage&&"undefined"!==typeof Storage&&localStorage.removeItem("tvChannel")},retrieveChannel:function(){var a=window.location.hash.substring(1);
        !0===e.useLocalStorage&&"undefined"!==typeof Storage&&""===a&&"undefined"!==localStorage.tvChannel&&""!==localStorage.tvChannel?window.location.hash=localStorage.getItem("tvChannel"):d.handleHashChange()}};f.fn.tv=function(b){e=f.extend({name:"TV Streamer",mobileSupport:!0,useLocalStorage:!0,channels:[{}],defaultChannel:!1,autoPlay:!0,useTitle:!0,allowPiP:!0},b);f(this).addClass("tvContainer");a=f.extend({root:f(this)},a);d.tv()}})(jQuery);